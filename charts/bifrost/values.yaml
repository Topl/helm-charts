# # Default values for bifrost.
# # This is a YAML-formatted file.
# # Declare variables to be passed into your templates.

name: bifrost-node

image:
  name: ghcr.io/topl/bifrost-node
  tag:

replicas: 1

resources:
  limits:
    cpu: 2.0
    memory: 2000Mi
  requests:
    cpu: 100m
    memory: 2000Mi

podSecurityContext:
  runAsUser: 1001 # TODO: Update Bifrost Docker container to use high UID. Add CKV_K8S_40 as a check.
  runAsGroup: 0
  fsGroup: 0
  seccompProfile:
    type: RuntimeDefault

securityContext:
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Refer to CLI: https://github.com/Topl/Bifrost#command-line-reference
args: ["--dataDir", "/mnt/bifrost/data", "--stakingDir", "/mnt/bifrost/staking"]
# args: ['--seed', 'test', '--forge']
# args: ['--network', 'valhalla']

command:
# command: ["tail", "-f", "/dev/null"] # Use this to debug Bifrost and exec into the running pod.

service:
  enabled: true
  type: ClusterIP
  ports:
    p2p: 9084
    rpc: 9085

ports:
  p2p: 9084
  rpc: 9085

configMap: # Optional
  # Where the config map should be mounted inside your container's filesystem.
  mountPath: /config/bifrost-config
  fileName: application.conf
  # Everything under content is copied verbatim into your service's configmap.
  content: |
    bifrost {
      chainReplicator {
      enableChainReplicator = false
      checkMissingBlock = true
      }
    }

volume:
  mountDirectory: /mnt/bifrost/
  # GKE specific storage classes: standard, standard-rwo, premium-rwo
  storageClass:
  storageSize: 10Gi

livenessProbe:
  enabled: false
  initialDelaySeconds: 30
  timeoutSeconds: 30
  periodSeconds: 60 # Perform check every x seconds.

readinessProbe:
  enabled: false
  initialDelaySeconds: 30
  timeoutSeconds: 30
  periodSeconds: 60 # Perform check every x seconds.
